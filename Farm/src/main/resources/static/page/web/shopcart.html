<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>购物车</title>
  <link rel="stylesheet" type="text/css" href="/assets/css/main.css">
  <link rel="stylesheet" type="text/css" href="/assets/libs/layui/css/layui.css">
  <script type="text/javascript" src="/assets/libs/layui/layui.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <script>
    layui.use(['layer','jquery'],function () {
      var layer = layui.layer,$ = layui.jquery;
      //检测是否登录，未登录不可访问购物车，且购物车内容为空。
      if (sessionStorage.getItem('username') == null) {
        $('.car_detail').html('<div style="height: 200px;width: 144px;"></div>');
        $('.already_pay').text('0');
        layer.msg('请先登录！',{icon:1,time:2000},function () {
          //跳转页面
          location.replace('/page/web/login.html');

        })
      }
    })
  </script>
</head>
<body>

  <div class="site-nav-bg">
    <div class="site-nav w1200">
      <p class="sn-back-home">
        <i class="layui-icon layui-icon-home"></i>
        <a href="commodity.html">首页</a>
      </p>
      <div class="sn-quick-menu">
        <div class="login"><a href="login.html">登录</a></div>
        <div class="sp-cart"><a href="shopcart.html">购物车</a><i class="layui-icon layui-icon-cart-simple"></i></div>
      </div>
    </div>
  </div>



  <div class="header">
    <div class="headerLayout w1200">
      <div class="headerCon">
        <h1 class="mallLogo">
          <a href="#" title="农产品">
            <img src="/assets/img/农产品小标题.png">
          </a>
        </h1>
        <div class="mallSearch">
          <!--<form action="" class="layui-form" novalidate>-->
            <!--<input type="text" name="title" required  lay-verify="required" autocomplete="off" class="layui-input" placeholder="请输入需要的商品">-->
            <!--<button class="layui-btn" lay-submit lay-filter="formDemo">-->
                <!--<i class="layui-icon layui-icon-search"></i>-->
            <!--</button>-->
            <!--<input type="hidden" name="" value="">-->
          <!--</form>-->
        </div>
      </div>
    </div>
  </div>

  <div class="content content-nav-base shopcart-content">
    <div class="main-nav">
      <div class="inner-cont0">
        <div class="inner-cont1 w1200">
          <div class="inner-cont2">
            <a href="commodity.html">所有商品</a>
            <a href="buytoday.html">今日团购</a>
            <a href="information.html">农产品资讯</a>
            <a href="about.html">关于我们</a>
          </div>
        </div>
      </div>
    </div>
    <div class="banner-bg w1200">
      <h3>天然无害 营养健康</h3>
      <p>今日团购好物 5折起</p>
    </div>
    <div class="cart w1200">
      <div class="cart-table-th">
        <div class="th th-chk">
          <div class="select-all">
            <div class="cart-checkbox">
              <input class="check-all check" id="allCheckked" type="checkbox" value="true">
            </div>
          <label>&nbsp;&nbsp;全选</label>
          </div>
        </div>
        <div class="th th-item">
          <div class="th-inner">
            商品
          </div>
        </div>
        <div class="th th-price">
          <div class="th-inner">
            单价
          </div>
        </div>
        <div class="th th-amount">
          <div class="th-inner">
            数量
          </div>
        </div>
        <div class="th th-sum">
          <div class="th-inner">
            小计
          </div>
        </div>
        <div class="th th-op">
          <div class="th-inner">
            操作
          </div>
        </div>  
      </div>
      <!--购物车内容-->
      <div class="OrderList">
        <div class="order-content car_detail" id="list-cont">

<!--           模版导入数据 -->
          <script type="text/html" id="demo">
            {{# layui.each(d.data,function(index,item){}}
            <ul class="item-content layui-clear" id="{{item.id}}">
              <li class="th th-chk">
                <div class="select-all">
                  <div class="cart-checkbox">
                    <input class="CheckBoxShop check" id="" type="checkbox" num="all" name="select-all" value="true">
                  </div>
                </div>
              </li>
              <li class="th th-item">
                <div class="item-cont">
                  <a href="javascript:;"><img src="{{item.img}}" alt=""></a>
                  <div class="text">
                    <div class="title">{{item.title}}</div>
                    <p><span>{{item.single}}</span>
<!--                      <span>{{item.cm}}</span>cm-->
                    </p>
                  </div>
                </div>
              </li>
              <li class="th th-price">
                <span class="th-su">{{item.pri}}</span>
              </li>
              <li class="th th-amount">
                <div class="box-btn layui-clear">
                  <div class="less layui-btn">-</div>
                  <input class="Quantity-input" type="" name="" value="{{item.num}}" disabled="disabled">
                  <div class="add layui-btn">+</div>
                </div>
              </li>
              <li class="th th-sum">
                <span class="sum">{{item.pri * item.num}}</span>
              </li>
              <li class="th th-op">
                <span class="dele-btn">删除</span>
              </li>
            </ul>
            {{# }); }}
          </script>
        </div>
      </div>





      <div class="FloatBarHolder layui-clear">
        <div class="th th-chk">
          <div class="select-all">
            <div class="cart-checkbox">
              <input class="check-all check" id=" " name="select-all" type="checkbox"  value="true">
            </div>
            <label>&nbsp;&nbsp;已选<span class="Selected-pieces already_pay">0</span>件</label>
          </div>
        </div>
        <div class="th batch-deletion">
          <span class="batch-dele-btn">批量删除</span>
        </div>
        <div class="th Settlement">
          <button class="layui-btn pay">结算</button>
        </div>
        <div class="th total">
          <p>应付：<span class="pieces-total already_pay"></span></p>
        </div>
      </div>
    </div>
  </div>

<script type="text/javascript">

  layui.config({
    base: '/assets/js/util/' //你存放新模块的目录，注意，不是layui的模块目录
  }).use(['mm','jquery','element','car','layer','login_on'],function(){
    var mm = layui.mm,$ = layui.$,element = layui.element,car = layui.car,layer = layui.layer,login_on = layui.login_on;

    $('html').hide();
    $('html').fadeIn(500);

    //显示用户
    login_on.login_success();
    //用户退出
    $('.quit').on('click',function () {
      login_on.login_quit();
      layer.msg('已成功退出',{icon:1,time:1500},function () {
        location.replace('/page/web/login.html');
      });
    })


    // 模版导入数据
    var html = demo.innerHTML,
    listCont = document.getElementById('list-cont');
    mm.request({
      url: '/main/shopping?userName='+ sessionStorage.getItem('username'),
      success : function(res){
        listCont.innerHTML = mm.renderHtml(html,res);
        element.render();
        car.init()
      },
      error: function(res){
        console.log(res);
      }
    })


    car.init();





});
</script>
  <script>

  </script>
</body>
</html>